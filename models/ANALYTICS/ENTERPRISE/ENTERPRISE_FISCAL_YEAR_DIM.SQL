{{ config(
  description = 'FISCAL_YEAR dimension', 
  materialized = 'view', 
  schema = 'ENTERPRISE', 
  tags = ['MART'],
  alias = 'FISCAL_YEAR_DIM'
) }} 

SELECT 
    FISCAL_YEAR_KEY,
    FISCAL_YEAR,
    FISCAL_YEAR_KEY = (SELECT FISCAL_YEAR_KEY FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE())	IS_CURRENT_FISCAL_YEAR	,
    FISCAL_YEAR_KEY = (SELECT FISCAL_YEAR_KEY FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE()) - 1	IS_PRIOR_FISCAL_YEAR	,
    FISCAL_YEAR_BEGIN_DATE,
    FISCAL_YEAR_END_DATE,
    TOTAL_DAYS_IN_FISCAL_YEAR,
    TOTAL_FISCAL_WEEKS_IN_FISCAL_YEAR,
    TOTAL_FISCAL_MONTHS_IN_FISCAL_YEAR,
    TOTAL_FISCAL_QUARTERS_IN_FISCAL_YEAR,
    FISCAL_YEAR_SEQUENCE,
    FISCAL_YEAR_PRIOR,
    BIW_INS_DTTM,
    BIW_UPD_DTTM,
    BIW_BATCH_ID
FROM  {{ref('MART_FISCAL_YEAR')}} 