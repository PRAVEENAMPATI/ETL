{{ config(
  description = 'FISCAL_MONTH dimension', 
  materialized = 'view', 
  schema = 'ENTERPRISE', 
  tags = ['MART'],
  alias = 'FISCAL_MONTH_DIM'
) }} 

SELECT 
    FISCAL_MONTH_KEY,
    FISCAL_MONTH,
    FISCAL_MONTH_KEY = (SELECT FISCAL_MONTH_KEY FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE())	IS_CURRENT_FISCAL_MONTH	,
    FISCAL_MONTH_SEQUENCE = (SELECT FISCAL_MONTH_SEQUENCE FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE()) - 1	IS_PRIOR_FISCAL_MONTH	,
    FISCAL_MONTH_SEQUENCE = (SELECT FISCAL_MONTH_SEQUENCE FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE()) - 12	IS_PRIOR_FISCAL_YEAR_CURRENT_FISCAL_MONTH	,
    FISCAL_MONTH_NUMBER,
    FISCAL_MONTH_DESCRIPTION,
    FISCAL_MONTH_BEGIN_DATE,
    FISCAL_MONTH_END_DATE,
    TOTAL_DAYS_IN_FISCAL_MONTH,
    TOTAL_FISCAL_WEEKS_IN_FISCAL_MONTH,
    FISCAL_MONTH_SEQUENCE,
    FISCAL_MONTH_IN_FISCAL_QUARTER,
    FISCAL_MONTH_IN_FISCAL_YEAR,
    FISCAL_QUARTER_KEY,
    FISCAL_QUARTER,
    FISCAL_QUARTER_YYYYQQ,
    FISCAL_QUARTER_KEY = (SELECT FISCAL_QUARTER_KEY FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE())	IS_CURRENT_FISCAL_QUARTER	,
    FISCAL_QUARTER_SEQUENCE = (SELECT FISCAL_QUARTER_SEQUENCE FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE()) - 1	IS_PRIOR_FISCAL_QUARTER	,
    FISCAL_QUARTER_SEQUENCE = (SELECT FISCAL_QUARTER_SEQUENCE FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE()) - 4	IS_PRIOR_FISCAL_YEAR_CURRENT_FISCAL_QUARTER	,
    FISCAL_QUARTER_NUMBER,
    FISCAL_QUARTER_DESCRIPTION,
    FISCAL_QUARTER_BEGIN_DATE,
    FISCAL_QUARTER_END_DATE,
    TOTAL_DAYS_IN_FISCAL_QUARTER,
    TOTAL_FISCAL_WEEKS_IN_FISCAL_QUARTER,
    TOTAL_FISCAL_MONTHS_IN_FISCAL_QUARTER,
    FISCAL_QUARTER_SEQUENCE,
    FISCAL_QUARTER_IN_FISCAL_YEAR,
    FISCAL_QUARTER_PRIOR_FOUR,
    FISCAL_QUARTER_PRIOR_THREE,
    FISCAL_QUARTER_PRIOR_TWO,
    FISCAL_QUARTER_PRIOR,
    FISCAL_QUARTER_NEXT,
    FISCAL_QUARTER_NEXT_TWO,
    FISCAL_QUARTER_NEXT_THREE,
    FISCAL_QUARTER_NEXT_FOUR,
    FISCAL_QUARTER_PRIOR_YEAR,
    FISCAL_YEAR_KEY,
    FISCAL_YEAR,
    FISCAL_YEAR_KEY = (SELECT FISCAL_YEAR_KEY FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE())	IS_CURRENT_FISCAL_YEAR	,
    FISCAL_YEAR_KEY = (SELECT FISCAL_YEAR_KEY FROM {{ref('MART_DATE')}} WHERE CALENDAR_DATE = CURRENT_DATE()) - 1	IS_PRIOR_FISCAL_YEAR	,
    FISCAL_YEAR_BEGIN_DATE,
    FISCAL_YEAR_END_DATE,
    TOTAL_DAYS_IN_FISCAL_YEAR,
    TOTAL_FISCAL_WEEKS_IN_FISCAL_YEAR,
    TOTAL_FISCAL_MONTHS_IN_FISCAL_YEAR,
    TOTAL_FISCAL_QUARTERS_IN_FISCAL_YEAR,
    FISCAL_YEAR_SEQUENCE,
    FISCAL_YEAR_PRIOR,
    FISCAL_MONTH_PRIOR,
    FISCAL_MONTH_PRIOR_BEGIN_DATE,
    FISCAL_MONTH_PRIOR_END_DATE,
    FISCAL_QUARTER_PRIOR_BEGIN_DATE,
    FISCAL_QUARTER_PRIOR_END_DATE,
    BIW_INS_DTTM,
    BIW_UPD_DTTM,
    BIW_BATCH_ID
FROM {{ref('MART_FISCAL_MONTH')}} 