{{ config(
  description = 'QUARTER dimension', 
  materialized = 'view', 
  schema = 'ENTERPRISE', 
  tags = ['MART'],
  alias = 'QUARTER_DIM'
) }} 

SELECT 
    QUARTER_KEY,
    QUARTER,
    QUARTER_KEY = CAST(YEAR(CURRENT_DATE()) || QUARTER(CURRENT_DATE()) AS INT)	IS_CURRENT_QUARTER	,
    QUARTER_SEQUENCE = 4*(CAST(YEAR(CURRENT_DATE()) AS INT) - 1970) + (CAST(QUARTER(CURRENT_DATE()) AS INT) - 2)	IS_PRIOR_QUARTER	,
    QUARTER_SEQUENCE = 4*(CAST(YEAR(CURRENT_DATE()) AS INT) - 1970) + (CAST(QUARTER(CURRENT_DATE()) AS INT) - 5)	IS_PRIOR_YEAR_CURRENT_QUARTER	,
    QUARTER_NUMBER,
    QUARTER_DESCRIPTION,
    QUARTER_BEGIN_DATE,
    QUARTER_END_DATE,
    TOTAL_DAYS_IN_QUARTER,
    TOTAL_MONTHS_IN_QUARTER,
    QUARTER_SEQUENCE,
    QUARTER_IN_YEAR,
    YEAR_KEY,
    YEAR,
    YEAR_KEY = CAST(YEAR(CURRENT_DATE()) AS INT)	IS_CURRENT_YEAR	,
    YEAR_KEY = CAST(YEAR(CURRENT_DATE()) AS INT) - 1	IS_PRIOR_YEAR	,
    YEAR_DESCRIPTION,
    YEAR_BEGIN_DATE,
    YEAR_END_DATE,
    TOTAL_DAYS_IN_YEAR,
    TOTAL_MONTHS_IN_YEAR,
    TOTAL_QUARTERS_IN_YEAR,
    YEAR_SEQUENCE,
    BIW_INS_DTTM,
    BIW_UPD_DTTM,
    BIW_BATCH_ID	
FROM  {{ref('MART_QUARTER')}} 