{{ config(
  description = 'MONTH dimension', 
  materialized = 'view', 
  schema = 'ENTERPRISE', 
  tags = ['MART'],
  alias = 'MONTH_DIM'
) }} 

SELECT 
    MONTH_KEY,
    MONTH,
    MONTH_KEY = CAST (TO_CHAR (CURRENT_DATE(), 'YYYYMM') AS INT)	IS_CURRENT_MONTH	,
    MONTH_SEQUENCE = 12*(CAST(YEAR(CURRENT_DATE()) AS INT) - 1970) + (CAST(MONTH(CURRENT_DATE()) AS INT) - 2)	IS_PRIOR_MONTH	,
    MONTH_SEQUENCE = 12*(CAST(YEAR(CURRENT_DATE()) AS INT) - 1970) + (CAST(MONTH(CURRENT_DATE()) AS INT) - 13)	IS_PRIOR_YEAR_CURRENT_MONTH	,
    MONTH_NUMBER,
    MONTH_SHORT_DESCRIPTION,
    MONTH_DESCRIPTION,
    MONTH_BEGIN_DATE,
    MONTH_END_DATE,
    TOTAL_DAYS_IN_MONTH,
    MONTH_SEQUENCE,
    MONTH_IN_QUARTER,
    MONTH_IN_YEAR,
    QUARTER_KEY,
    QUARTER,
    QUARTER_KEY = CAST(YEAR(CURRENT_DATE()) || QUARTER(CURRENT_DATE()) AS INT)	IS_CURRENT_QUARTER	,
    QUARTER_SEQUENCE = 4*(CAST(YEAR(CURRENT_DATE()) AS INT) - 1970) + (CAST(QUARTER(CURRENT_DATE()) AS INT) - 2)	IS_PRIOR_QUARTER	,
    QUARTER_SEQUENCE = 4*(CAST(YEAR(CURRENT_DATE()) AS INT) - 1970) + (CAST(QUARTER(CURRENT_DATE()) AS INT) - 5)	IS_PRIOR_YEAR_CURRENT_QUARTER	,
    QUARTER_NUMBER,
    QUARTER_DESCRIPTION,
    QUARTER_BEGIN_DATE,
    QUARTER_END_DATE,
    TOTAL_DAYS_IN_QUARTER,
    TOTAL_MONTHS_IN_QUARTER,
    QUARTER_SEQUENCE,
    QUARTER_IN_YEAR,
    YEAR_KEY,
    YEAR,
    YEAR_KEY = CAST(YEAR(CURRENT_DATE()) AS INT)	IS_CURRENT_YEAR	,
    YEAR_KEY = CAST(YEAR(CURRENT_DATE()) AS INT) - 1	IS_PRIOR_YEAR	,
    YEAR_DESCRIPTION,
    YEAR_BEGIN_DATE,
    YEAR_END_DATE,
    TOTAL_DAYS_IN_YEAR,
    TOTAL_MONTHS_IN_YEAR,
    TOTAL_QUARTERS_IN_YEAR,
    YEAR_SEQUENCE,
    BIW_INS_DTTM,
    BIW_UPD_DTTM,
    BIW_BATCH_ID	
FROM  {{ref('MART_MONTH')}} 