/*---------------------------------------------------------------------------
Command to run model:
--dbt run --select ETL_MART_SALES_BACKLOG_FACT_QUANTENNA_ONE_TIME_LOAD+ --vars 'is_backfill: True'

Version     Date            Author          Description
-------     --------        -----------     ----------------------------------
1.0         10/03/2022      Sruthi Kasbe    Initial Version
2.0         12/12/2022      Sruthi Kasbe    Adding new columns and Rearranging the columns
3.0         04/19/2023     	Mattuvarkulali M    Added new column ODM_END_CORP_CD
---------------------------------------------------------------------------*/
{################# EDW Job Template Variables #################}
{%-set v_pk_list = ['BACKLOG_KEY']-%}
{% if is_incremental() %}
{%-set v_house_keeping_column = ['BIW_INS_DTTM','BIW_UPD_DTTM','BIW_BATCH_ID','BIW_MD5_KEY']-%}
{%-set v_md5_column_list =  edw_get_md5_column_list( this ,v_pk_list|list+ v_house_keeping_column|list ) -%}
{%-set v_all_column_list =  edw_get_column_list( this ) -%}
--DBT Variable
--SELECT {{v_all_column_list}}
--SELECT {{v_md5_column_list}}
{% endif %}

{################# Batch control insert and update SQL #################}
{%- set v_dbt_job_name = 'DBT_ETL_MART_SALES_BACKLOG_FACT_QUANTENNA_ONE_TIME_LOAD'-%}
-- Step 1 Batch process info
{%- set v_watermark = edw_batch_control(v_dbt_job_name,config.get('schema'),config.get('alias') ,config.get('tags'),config.get('materialized') ) -%}
{%- set V_LWM = v_watermark[0] -%}
{%- set V_HWM = v_watermark[1] -%}
{%- set V_START_DTTM = v_watermark[2] -%}
{%- set V_BIW_BATCH_ID = v_watermark[3] -%}
{%- set v_sql_upd_success_batch = "CALL UTILITY.EDW_BATCH_SUCCESS_PROC('"~v_dbt_job_name~"')" -%}
{%- set V_EDW_DB = var('V_EDW_DEFAULT_DB') +env_var('DBT_DEP_ENV')+'.' -%}

{################# Snowflake Object Configuration #################}
{{
    config(
         description = 'Building table BACKLOG_FACT_QUANTENNA_ONE_TIME_LOAD for MART_SALES'
        ,transient=true
        ,materialized='view'
        ,schema ='ETL_MART_SALES'
        ,alias='BACKLOG_FACT_QUANTENNA'
		,unique_key= v_pk_list
        ,tags =['MART_SALES']
		,post_hook= [v_sql_upd_success_batch]	
        )
}}


------------------------------------ CORPORATION REFERENCE ---------------------------------------------
WITH CORPORATION AS
(
SELECT
KEY_CORPORATION,
CORP_CD
FROM
 {{source('STG_SDM_PRESENTATION','LKP_CORPORATIONS')}}
),

------------------------------------ QUANTENNA & CORPORATION REFERENCE ---------------------------------------------
BACKLOG_QUANTENNA AS 
(
SELECT 
        MD5(OBJECT_CONSTRUCT ('COL1',ACTIVITY::STRING
                        , 'COL2',SALES_ORDER_NUM::STRING
                        , 'COL3',JOURNAL_DESCRIPTION::STRING
                        , 'COL4',KEY_QUANTENNABACKLOG::STRING
						, 'COL5',PROCESS_DATE::STRING
                        )::STRING ) AS BACKLOG_KEY,
		MD5(COALESCE(QUAN.DIR_CUST_CD,'-1')) AS DIRECT_CUSTOMER_KEY,
        MD5(COALESCE(QUAN.IND_CUST_CD,'-1')) AS INDIRECT_CUSTOMER_KEY,
        MD5(COALESCE(QUAN.END_CUST_CD,'-1')) AS END_CUSTOMER_KEY,
		MD5(COALESCE(DIR_CORP.CORP_CD,QUAN.KEY_DIRCORPORATION::string)) AS DIRECT_CORPORATION_KEY,
		MD5(COALESCE(ENDIR_CORP.CORP_CD,QUAN.KEY_ENDCORPORATION::string)) AS END_CORPORATION_KEY,
		MD5(COALESCE(QUAN.PRODUCT_ID,'-1')) AS MARKET_PRODUCT_NUMBER_KEY,
		MD5(COALESCE(QUAN.PRODUCT_ID,'-1')) AS INTERNAL_PART_NUMBER_KEY,
        DIR_CORP.CORP_CD AS DIRECT_CORPORATION_CODE,
		ENDIR_CORP.CORP_CD AS END_CORPORATION_CODE,
        QUAN.IND_CUST_CD AS INDIRECT_CUSTOMER_CODE,
		QUAN.ACCRUAL_AMOUNT AS ACCRUAL_AMOUNT_USD,
		QUAN.ACCRUAL_CATEGORY AS ACCRUAL_CATEGORY,
		QUAN.ACCRUAL_COMMENTS AS ACCRUAL_COMMENTS,
		QUAN.ACCRUAL_FACTOR AS ACCRUAL_FACTOR,
		QUAN.ACCRUAL_RULEID AS ACCRUAL_RULE_ID,
		QUAN.ACCRUAL_RULESET AS ACCRUAL_RULE_SET,
		QUAN.ACCRUAL_TRANSACTION_DATE AS ACCRUAL_TRANSACTION_DATE,
		QUAN.ACCRUAL_TYPE AS ACCRUAL_TYPE,
		QUAN.ACTIVITY AS ACTIVITY,
		QUAN.BACKLOG_GROSS_USD,
		QUAN.BACKLOG_GROSS_EUR,
		QUAN.BACKLOG_GROSS_JPY,
		QUAN.BACKLOG_NET_USD,
		QUAN.BACKLOG_NET_EUR,
		QUAN.BACKLOG_NET_JPY,
		QUAN.BACKLOG_QTY AS BACKLOG_NET_QUANTITY,
		QUAN.BILL_SOURCE_CD AS BILL_SOURCE_CODE,
		QUAN.BLANKET_ORDER_FLAG::BOOLEAN AS IS_BLANKET_ORDER,
		QUAN.BOOKING_AND_BILLING_CD AS BOOKING_AND_BILLING_CODE,
		QUAN.BOOKING_CATEGORY AS BOOKING_CATEGORY,
		QUAN.BOOKING_FLG::BOOLEAN AS IS_BOOKING,
		QUAN.COI AS CUSTOMER_OF_INTEREST,
		QUAN.CONTRACT_CURRENCY AS CONTRACT_CURRENCY,
		QUAN.CONTRACT_CURRENCY_ACCRUAL_AMT AS ACCRUAL_AMOUNT_CONTRACT_CURRENCY,
		QUAN.CONTRACT_CURRENCY_GROSS_AMT AS GROSS_AMOUNT_CONTRACT_CURRENCY,
		QUAN.CONTRACT_CURRENCY_NET_AMT AS BACKLOG_NET_AMOUNT_CONTRACT_CURRENCY,
		QUAN.CPN AS CUSTOMER_PART_NUMBER,
		QUAN.CRD_DATE AS CUSTOMER_REQUESTED_DATE,
		QUAN.CRD_Delq_Flag::BOOLEAN AS IS_CRD_DELQ,
		QUAN.CREDIT_ACCOUNT AS CREDIT_ACCOUNT,
		QUAN.CRSD_Date AS REQUESTED_SHIP_DATE,
		QUAN.CRSD_Delq_Flag::BOOLEAN AS IS_CRSD_DELQ,
		QUAN.CSR AS CUSTOMER_SERVICE_REPRESENTATIVE,
		QUAN.TRANSACTION_CURRENCY AS TRANSACTION_CURRENCY_ISO_CODE,
		QUAN.CUSPA_NUMBER AS CUSTOMER_PA_NUMBER,
		QUAN.CUST_PO_NUMBER AS CUSTOMER_PO_NUMBER,
		QUAN.CUST_RECPT_BANK_CD AS CUSTOMER_RECIEPT_BANK_CODE,
		QUAN.DEBIT_ACCOUNT AS DEBIT_ACCOUNT,
		QUAN.DELIVERY_REQUEST_DATE AS DELIVERY_REQUEST_DATE,
		QUAN.DELIVERY_SOURCE_CD AS DELIVERY_SOURCE_CD,
		QUAN.DELVRY_HOLD_STATUS AS ORDER_DELIVERY_HOLD_STATUS,
		QUAN.DEMAND_BANK AS DEMAND_BANK,
		QUAN.DEMAND_CLASS AS DEMAND_CLASS,
		QUAN.DEMAND_TYPE AS DEMAND_TYPE,
		QUAN.DIR_CUST_CD AS DIRECT_CUSTOMER_CODE,
		QUAN.DLVRY_STATUS_DTME AS ORDER_DELIVERY_STATUS_DTME,
		QUAN.END_CUST_CD AS END_CUSTOMER_CODE,
		QUAN.ENTRY_DT AS ENTRY_DATE,
		QUAN.EPSD_DT AS EARLIEST_POSSIBLE_SHIP_DATE,
		QUAN.FMS_SERVICE_PROGRAM AS FMS_SERVICE_PROGRAM,
		QUAN.HANDLING_CODE AS HANDLING_CODE,
		QUAN.HDR_HOLD_STATUS AS ORDER_HDR_HOLD_STATUS,
		QUAN.PRODUCT_ID AS INTERNAL_PART_NUMBER,
		QUAN.INVENTORY_INSURANCE_COVERAGE AS INVENTORY_INSURANCE_COVERAGE,
		QUAN.INVOICE_NUM AS INVOICE_NUM,
		QUAN.INVOICED_QUANTITY AS INVOICED_QUANTITY,
		QUAN.ITM_HOLD_STATUS AS ORDER_ITM_HOLD_STATUS,
		QUAN.JOURNAL_DESCRIPTION AS JOURNAL_DESCRIPTION,
		QUAN.LIABILITY_AGREEMENT AS LIABILITY_AGREEMENT,
		QUAN.LINE_STATUS AS ORDER_LINE_STATUS,
		QUAN.PRODUCT_ID AS MARKET_PRODUCT_NUMBER,
		QUAN.MRSD_Date AS MANUFACTURER_RESCHEDULED_SHIP_DATE,
		QUAN.MRSD_Delq_Flag::BOOLEAN AS IS_MRSD_DELQ,
		QUAN.MSD_Date AS ORIGINAL_SCHEDULED_SHIP_DATE,
		QUAN.MSD_Delq_Flag::BOOLEAN AS IS_MSD_DELQ,
		QUAN.OBR_TRX_ID AS OBR_TRX_ID,
		QUAN.OPERATING_UNIT AS OPERATING_UNIT,
		NULL AS ORA_DELIVERY_STATUS_CODE,
		QUAN.DLVRY_STATUS_CD AS DELIVERY_STATUS_CODE,
		QUAN.ORDER_SOURCE_CD AS ORDER_SOURCE_CODE,
		QUAN.ORDER_STATUS AS ORDER_STATUS,
		QUAN.ORDER_TYPE_CD AS ORDER_TYPE_CODE,
		QUAN.PDD_Date AS PLANNED_DELIVERY_DATE,
		QUAN.PDD_Delq_Flag::BOOLEAN AS IS_PDD_DELQ,
		QUAN.PICK_QUANTITY AS PICK_QUANTITY,
		QUAN.PRICE_SOURCE AS PRICE_SOURCE,
		QUAN.PROCESS_DATE AS PROCESS_DATE,
		QUAN.RDD_Date AS RESCHEDULED_DELIVERY_DATE,
		QUAN.RDD_Delq_Flag::BOOLEAN AS IS_RDD_DELQ,
		QUAN.RSD_DT AS SCHEDULED_SHIPPED_DATE,
		QUAN.Sales_Delivery_Num AS LEGACY_SALES_DELIVERY_NUMBER,
		QUAN.Sales_Item_Num AS LEGACY_SALES_ITEM_NUMBER,
		QUAN.SALES_ORDER_LI_DL AS SALES_ORDER_LINE_ITEM_DELIVERY,
		QUAN.Sales_Order_Num AS LEGACY_SALES_ORDER_NUMBER,
		QUAN.SALES_QUOTE_NUM AS SALES_QUOTE_NUM,
		QUAN.SAMPLES_FLG::BOOLEAN AS IS_SAMPLES,
		QUAN.SHIP_CONFIRMED_QTY AS SHIP_CONFIRMED_QTY,
		QUAN.SOLD_TO_CUST_CD AS SOLD_TO_CUST_CODE,
		QUAN.SOURCE_DEMAND_BANK AS SOURCE_DEMAND_BANK,
		QUAN.Source_Of_Sale AS SOURCE_OF_SALE,
		QUAN.SPA_CODE AS SERVICE_PROGRAM_CODE,
		QUAN.SPA_NAME AS SERVICE_PROGRAM_CUSTOMER,
		QUAN.TRANSACTION_DATE AS TRANSACTION_DATE,
		QUAN.TRANSIT_DAYS AS TRANSIT_DAYS,
		QUAN.TRUE_BACKLOG_FLAG::BOOLEAN AS IS_TRUE_BACKLOG,
		QUAN.TRX_ACCRUAL_AMT AS ACCRUAL_AMOUNT_TRANSACTION_CURRENCY,
		QUAN.TRX_UNIT_PRICE AS UNIT_PRICE_TRANSACTION_CURRENCY,
		QUAN.U_PRICE_CRRT_AMT AS UNIT_PRICE_CRRT_AMT,
		QUAN.U_PRICE_SOURCE_CD AS UNIT_PRICE_SOURCE_CD,
		QUAN.WS_Flag::BOOLEAN AS IS_WS_FLAG,
		NULL AS IS_SALES_TRUE_BACKLOG,
		NULL AS NNCO_AGREEMENT_TYPE,
		NULL AS IS_NNCO,
		NULL AS LINE_NUMBER,
		NULL AS ORDER_DLVRY_SOURCE_CODE,
		NULL AS ORDER_NUMBER,
        NULL AS BACKLOG_GROSS_AMOUNT_TRANSACTION_CURRENCY,
        NULL AS BACKLOG_NET_AMOUNT_TRANSACTION_CURRENCY,
		NULL AS UNIT_PRICE_USD,
		NULL AS UNIT_PRICE_EUR,
		NULL AS UNIT_PRICE_JPY,
		NULL AS REGION,
		NULL AS BUSINESS_CLASS_CODE,
		QUAN.ACCRUAL_STATUS,
		QUAN.CPN_REVISION_CD AS CPN_REVISION_CODE,
		QUAN.FILE_NAME,
		NULL AS ODM_END_CORP_CD,
		'{{V_START_DTTM}}'::TIMESTAMP_NTZ BIW_INS_DTTM ,
		'{{V_START_DTTM}}'::TIMESTAMP_NTZ BIW_UPD_DTTM ,
		{{V_BIW_BATCH_ID}} as BIW_BATCH_ID

	FROM {{source('STG_SDM_PRESENTATION','FACT_QUANTENNABACKLOG_BASE')}} QUAN
	LEFT JOIN CORPORATION DIR_CORP
	    ON QUAN.KEY_DIRCORPORATION= DIR_CORP.KEY_CORPORATION
	LEFT JOIN CORPORATION ENDIR_CORP
	    ON QUAN.KEY_ENDCORPORATION= ENDIR_CORP.KEY_CORPORATION
)

SELECT 
    BACKLOG_KEY, 
    DIRECT_CUSTOMER_KEY,
    INDIRECT_CUSTOMER_KEY,       
    END_CUSTOMER_KEY,      
    DIRECT_CORPORATION_KEY,
    END_CORPORATION_KEY,        
    MARKET_PRODUCT_NUMBER_KEY, 
    INTERNAL_PART_NUMBER_KEY,   
    PROCESS_DATE,
    DIRECT_CUSTOMER_CODE,
    INDIRECT_CUSTOMER_CODE,                                  
    END_CUSTOMER_CODE,                                  
    DIRECT_CORPORATION_CODE,
    END_CORPORATION_CODE,
    MARKET_PRODUCT_NUMBER,
    INTERNAL_PART_NUMBER,
    CUSTOMER_PART_NUMBER,
    SOURCE_OF_SALE,
    SALES_ORDER_LINE_ITEM_DELIVERY,
    REGION,
    LEGACY_SALES_ORDER_NUMBER,
    LEGACY_SALES_ITEM_NUMBER,
    LEGACY_SALES_DELIVERY_NUMBER,
    SALES_QUOTE_NUM,
    ORDER_TYPE_CODE,
    ACCRUAL_AMOUNT_USD,
    ACCRUAL_CATEGORY,
    ACCRUAL_COMMENTS,
    ACCRUAL_FACTOR,
    ACCRUAL_RULE_ID,
    ACCRUAL_RULE_SET,
    ACCRUAL_TRANSACTION_DATE,
    ACCRUAL_TYPE,
    ACTIVITY,
    BACKLOG_GROSS_USD, 
    BACKLOG_GROSS_EUR,
    BACKLOG_GROSS_JPY,
    BACKLOG_NET_USD, 
    BACKLOG_NET_EUR,
    BACKLOG_NET_JPY,
    BACKLOG_NET_QUANTITY,
    BACKLOG_GROSS_AMOUNT_TRANSACTION_CURRENCY,
    BACKLOG_NET_AMOUNT_TRANSACTION_CURRENCY,
    BILL_SOURCE_CODE,
    IS_BLANKET_ORDER,
    BOOKING_AND_BILLING_CODE,
    BOOKING_CATEGORY,
    IS_BOOKING,
    CUSTOMER_OF_INTEREST,
    CONTRACT_CURRENCY,
    ACCRUAL_AMOUNT_CONTRACT_CURRENCY,
    GROSS_AMOUNT_CONTRACT_CURRENCY,
    BACKLOG_NET_AMOUNT_CONTRACT_CURRENCY,
    CUSTOMER_REQUESTED_DATE,
    IS_CRD_DELQ,
    CREDIT_ACCOUNT,
    REQUESTED_SHIP_DATE,
    IS_CRSD_DELQ,
    CUSTOMER_SERVICE_REPRESENTATIVE,
    TRANSACTION_CURRENCY_ISO_CODE,
    CUSTOMER_PA_NUMBER,
    CUSTOMER_PO_NUMBER,
    CUSTOMER_RECIEPT_BANK_CODE,
    DEBIT_ACCOUNT,
    DELIVERY_REQUEST_DATE,
    DELIVERY_SOURCE_CD,
    ORDER_DELIVERY_HOLD_STATUS,
    DEMAND_BANK,
    DEMAND_CLASS,
    DEMAND_TYPE,
    ORDER_DELIVERY_STATUS_DTME,
    ENTRY_DATE,
    EARLIEST_POSSIBLE_SHIP_DATE,
    FMS_SERVICE_PROGRAM,
    HANDLING_CODE,
    ORDER_HDR_HOLD_STATUS,
    INVENTORY_INSURANCE_COVERAGE,
    INVOICE_NUM,
    INVOICED_QUANTITY,
    ORDER_ITM_HOLD_STATUS,
    JOURNAL_DESCRIPTION,
    LIABILITY_AGREEMENT,
    ORDER_LINE_STATUS,
    MANUFACTURER_RESCHEDULED_SHIP_DATE,
    IS_MRSD_DELQ,
    ORIGINAL_SCHEDULED_SHIP_DATE,
    IS_MSD_DELQ,
    NNCO_AGREEMENT_TYPE,
    IS_NNCO,
    OBR_TRX_ID,
    OPERATING_UNIT,
	ORA_DELIVERY_STATUS_CODE,
    DELIVERY_STATUS_CODE,
    LINE_NUMBER,
    ORDER_DLVRY_SOURCE_CODE,
    ORDER_NUMBER,
    ORDER_SOURCE_CODE,
    ORDER_STATUS,
    PLANNED_DELIVERY_DATE,
    IS_PDD_DELQ,
    PICK_QUANTITY,
    PRICE_SOURCE,
    RESCHEDULED_DELIVERY_DATE,
    IS_RDD_DELQ,
    SCHEDULED_SHIPPED_DATE,
    IS_SAMPLES,
    SHIP_CONFIRMED_QTY,
    SOLD_TO_CUST_CODE,
    SOURCE_DEMAND_BANK,
    SERVICE_PROGRAM_CODE,
    SERVICE_PROGRAM_CUSTOMER,
    TRANSACTION_DATE,
    TRANSIT_DAYS,
    IS_TRUE_BACKLOG,
    IS_SALES_TRUE_BACKLOG,
    ACCRUAL_AMOUNT_TRANSACTION_CURRENCY,
    UNIT_PRICE_TRANSACTION_CURRENCY,
    UNIT_PRICE_CRRT_AMT,
    UNIT_PRICE_SOURCE_CD,
    UNIT_PRICE_USD,
    UNIT_PRICE_EUR,
    UNIT_PRICE_JPY,
    IS_WS_FLAG,
    BUSINESS_CLASS_CODE,
	ACCRUAL_STATUS,
	CPN_REVISION_CODE,
	FILE_NAME,
	ODM_END_CORP_CD, 
    BIW_INS_DTTM, 
    BIW_UPD_DTTM, 
    BIW_BATCH_ID,
	md5(object_construct ('col1',DIRECT_CUSTOMER_KEY::string, 'col2',INDIRECT_CUSTOMER_KEY::string,
						'col3',END_CUSTOMER_KEY::string, 'col4',DIRECT_CORPORATION_KEY::string, 'col5',END_CORPORATION_KEY::string,
						'col6',MARKET_PRODUCT_NUMBER_KEY::string, 'col7',INTERNAL_PART_NUMBER_KEY::string, 'col8',PROCESS_DATE::string,
						'col9',DIRECT_CUSTOMER_CODE::string, 'col10',INDIRECT_CUSTOMER_CODE::string, 'col11',END_CUSTOMER_CODE::string,
						'col12',DIRECT_CORPORATION_CODE::string, 'col13',END_CORPORATION_CODE::string, 'col14',MARKET_PRODUCT_NUMBER::string,
						'col15',INTERNAL_PART_NUMBER::string, 'col16',CUSTOMER_PART_NUMBER::string, 'col17',SOURCE_OF_SALE::string,
						'col18',SALES_ORDER_LINE_ITEM_DELIVERY::string, 'col19',REGION::string, 'col20',LEGACY_SALES_ORDER_NUMBER::string,
						'col21',LEGACY_SALES_ITEM_NUMBER::string, 'col22',LEGACY_SALES_DELIVERY_NUMBER::string, 'col23',SALES_QUOTE_NUM::string,
						'col24',ORDER_TYPE_CODE::string, 'col25',ACCRUAL_AMOUNT_USD::string, 'col26',ACCRUAL_CATEGORY::string,
						'col27',ACCRUAL_COMMENTS::string, 'col28',ACCRUAL_FACTOR::string, 'col29',ACCRUAL_RULE_ID::string, 'col30',ACCRUAL_RULE_SET::string,
						'col31',ACCRUAL_TRANSACTION_DATE::string, 'col32',ACCRUAL_TYPE::string, 'col33',ACTIVITY::string, 'col34',BACKLOG_GROSS_USD::string,
						'col35',BACKLOG_GROSS_EUR::string, 'col36',BACKLOG_GROSS_JPY::string, 'col37',BACKLOG_NET_USD::string,
						'col38',BACKLOG_NET_EUR::string, 'col39',BACKLOG_NET_JPY::string, 'col40',BACKLOG_NET_QUANTITY::string,
						'col41',BACKLOG_GROSS_AMOUNT_TRANSACTION_CURRENCY::string, 'col42',BACKLOG_NET_AMOUNT_TRANSACTION_CURRENCY::string, 'col43',BILL_SOURCE_CODE::string,
						'col44',IS_BLANKET_ORDER::string, 'col45',BOOKING_AND_BILLING_CODE::string, 'col46',BOOKING_CATEGORY::string,
						'col47',IS_BOOKING::string, 'col48',CUSTOMER_OF_INTEREST::string, 'col49',CONTRACT_CURRENCY::string,
						'col50',ACCRUAL_AMOUNT_CONTRACT_CURRENCY::string, 'col51',GROSS_AMOUNT_CONTRACT_CURRENCY::string,
						'col52',BACKLOG_NET_AMOUNT_CONTRACT_CURRENCY::string, 'col53',CUSTOMER_REQUESTED_DATE::string, 'col54',IS_CRD_DELQ::string,
						'col55',CREDIT_ACCOUNT::string, 'col56',REQUESTED_SHIP_DATE::string, 'col57',IS_CRSD_DELQ::string,
						'col58',CUSTOMER_SERVICE_REPRESENTATIVE::string, 'col59',TRANSACTION_CURRENCY_ISO_CODE::string, 'col60',CUSTOMER_PA_NUMBER::string,
						'col61',CUSTOMER_PO_NUMBER::string, 'col62',CUSTOMER_RECIEPT_BANK_CODE::string, 'col63',DEBIT_ACCOUNT::string,
						'col64',DELIVERY_REQUEST_DATE::string, 'col65',DELIVERY_SOURCE_CD::string, 'col66',ORDER_DELIVERY_HOLD_STATUS::string,
						'col67',DEMAND_BANK::string, 'col68',DEMAND_CLASS::string, 'col69',DEMAND_TYPE::string,
						'col70',ORDER_DELIVERY_STATUS_DTME::string, 'col71',ENTRY_DATE::string, 'col72',EARLIEST_POSSIBLE_SHIP_DATE::string,
						'col73',FMS_SERVICE_PROGRAM::string, 'col74',HANDLING_CODE::string, 'col75',ORDER_HDR_HOLD_STATUS::string,
						'col76',INVENTORY_INSURANCE_COVERAGE::string, 'col77',INVOICE_NUM::string, 'col78',INVOICED_QUANTITY::string,
						'col79',ORDER_ITM_HOLD_STATUS::string, 'col80',JOURNAL_DESCRIPTION::string, 'col81',LIABILITY_AGREEMENT::string,
						'col82',ORDER_LINE_STATUS::string, 'col83',MANUFACTURER_RESCHEDULED_SHIP_DATE::string, 'col84',IS_MRSD_DELQ::string,
						'col85',ORIGINAL_SCHEDULED_SHIP_DATE::string, 'col86',IS_MSD_DELQ::string, 'col87',NNCO_AGREEMENT_TYPE::string, 'col88',IS_NNCO::string,
						'col89',OBR_TRX_ID::string, 'col90',OPERATING_UNIT::string, 'col91',ORA_DELIVERY_STATUS_CODE::string,
						'col92',DELIVERY_STATUS_CODE::string, 'col93',LINE_NUMBER::string, 'col94',ORDER_DLVRY_SOURCE_CODE::string,
						'col95',ORDER_NUMBER::string, 'col96',ORDER_SOURCE_CODE::string, 'col97',ORDER_STATUS::string,
						'col98',PLANNED_DELIVERY_DATE::string, 'col99',IS_PDD_DELQ::string, 'col100',PICK_QUANTITY::string, 'col101',PRICE_SOURCE::string,
						'col102',RESCHEDULED_DELIVERY_DATE::string, 'col103',IS_RDD_DELQ::string, 'col104',SCHEDULED_SHIPPED_DATE::string,
						'col105',IS_SAMPLES::string, 'col106',SHIP_CONFIRMED_QTY::string, 'col107',SOLD_TO_CUST_CODE::string,
						'col108',SOURCE_DEMAND_BANK::string, 'col109',SERVICE_PROGRAM_CODE::string, 'col110',SERVICE_PROGRAM_CUSTOMER::string,
						'col111',TRANSACTION_DATE::string, 'col112',TRANSIT_DAYS::string, 'col113',IS_TRUE_BACKLOG::string,
						'col114',IS_SALES_TRUE_BACKLOG::string, 'col115',ACCRUAL_AMOUNT_TRANSACTION_CURRENCY::string,
						'col116',UNIT_PRICE_TRANSACTION_CURRENCY::string, 'col117',UNIT_PRICE_CRRT_AMT::string, 'col118',UNIT_PRICE_SOURCE_CD::string,
						'col119',UNIT_PRICE_USD::string, 'col120',UNIT_PRICE_EUR::string, 'col121',UNIT_PRICE_JPY::string, 'col122',IS_WS_FLAG::string,
						'col123',BUSINESS_CLASS_CODE::string, 'col124',ACCRUAL_STATUS::string, 'col125',CPN_REVISION_CODE::string, 'col126',FILE_NAME::string, 'col127',ODM_END_CORP_CD::string
						)::string )::BINARY as BIW_MD5_KEY

FROM BACKLOG_QUANTENNA BKLG
