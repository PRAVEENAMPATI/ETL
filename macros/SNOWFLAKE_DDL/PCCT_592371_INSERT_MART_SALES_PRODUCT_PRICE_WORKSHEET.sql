/*---------------------------------------------------------------------------
command to run
dbt run-operation  PCCT_592371_INSERT_MART_SALES_PRODUCT_PRICE_WORKSHEET
Version     Date            Author              Description
-------     --------        -----------         ----------------------------------
1.0         28 Nov 2022      VINAYAKA CN       INSERTING BELOW 9 PRODUCT ID'S AS PER BUISNESS REQUEST
---------------------------------------------------------------------------*/
{% macro PCCT_592371_INSERT_MART_SALES_PRODUCT_PRICE_WORKSHEET() -%}
{################# Step 1 DECLARE SCRIPTS/DDL NEED TO EXECUTED #################}
{%- set v_scripts -%} 

INSERT INTO EDW{{env_var('DBT_DEP_ENV')}}.MART_SALES.PRODUCT_PRICE_WORKSHEET
(
    GPS_KEY , PRODUCT_ID , EFFECTIVE_FROM_DATE , EFFECTIVE_TO_DATE , STATUS , IS_DELETE , PRODUCT_KEY , DISTRIBUTOR_BOOK_PRICE_USD , END_POINT_PRICE_USD , FIELD_MINIMUM_QUANTITY ,
    MINIMUM_PACKAGE_QUANTITY , MULTIPLIER , REFERENCE_PRICE , STRATEGIC_MINIMUM_PRICE , WALK_AWAY_PRICE , FRAME_NAME , GPS_PRICE_CATEGORY , GPS_PROGRAM_DESCRIPTION , GPS_CATEGORY , GPS_CATEGORY_DESCRIPTION ,
    GPS_MARKET , GPS_MARKET_DESCRIPTION , GPS_PROGRAM_CODE , GPS_PROGRAM_CODE_DESCRIPTION , MARGIN_LEVEL , PRODUCT_FRAME_TYPE , PRODUCT_FRAME_TYPE_DESCRIPTION , IS_NCNR , IS_PRICE_BOOK , IS_QUOTE ,
    IS_STEP_PRICING , STAR_LEVEL , IS_FIRST_TIME_IN_PRICE_BOOK , ON_TARGET_REMOVAL_DATE , ON_TARGET_START_DATE , PHASE_OUT_END_DATE , PHASE_OUT_START_DATE , REFERENCE_QUANTITY ,
    MINIMUM_ORDER_QUANTITY , RESALE_PRICE , MINIMUM_DOLLAR_VALUE , COGS_PRICE , DISTRIBUTOR_BOOK_PRICE_EUR , DISTRIBUTOR_BOOK_PRICE_JPY , SOURCE_SYSTEM , BIW_INS_DTTM , BIW_UPD_DTTM , BIW_BATCH_ID

)
    SELECT  MD5(OBJECT_CONSTRUCT('COL1' ,'E-F44013CAA-N1-W1-ACP'	    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'E-F44013CAA-N1-W1-ACP'			, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('E-F44013CAA-N1-W1-ACP')		, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-285241'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENG3V2T45ASY'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENG3V2T45ASY'						, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENG3V2T45ASY')					, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-285300'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENG99251AS001'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENG99251AS001'					, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENG99251AS001')				, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-271360'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENGF775B0STP247ASY'		    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENGF775B0STP247ASY'				, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENGF775B0STP247ASY')			, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-293099'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'     
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENGFDMC3612ASY1'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENGFDMC3612ASY1'					, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENGFDMC3612ASY1')				, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-255240'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENGNCV7755ASASY'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENGNCV7755ASASY'					, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENGNCV7755ASASY')				, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-274660'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'F2XDCHAINA8S-AAA3B462-DSG'	::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'F2XDCHAINA8S-AAA3B462-DSG'		, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('F2XDCHAINA8S-AAA3B462-DSG')	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-250020'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999' ;

// inserting records to  MART_SALES.PRODUCT_PRICE_WORKSHEET_HIST

INSERT INTO EDW{{env_var('DBT_DEP_ENV')}}.MART_SALES.PRODUCT_PRICE_WORKSHEET_HIST
(
    GPS_KEY , PRODUCT_ID , EFFECTIVE_FROM_DATE , EFFECTIVE_TO_DATE , STATUS , IS_DELETE , PRODUCT_KEY , DISTRIBUTOR_BOOK_PRICE_USD , END_POINT_PRICE_USD , FIELD_MINIMUM_QUANTITY ,
    MINIMUM_PACKAGE_QUANTITY , MULTIPLIER , REFERENCE_PRICE , STRATEGIC_MINIMUM_PRICE , WALK_AWAY_PRICE , FRAME_NAME , GPS_PRICE_CATEGORY , GPS_PROGRAM_DESCRIPTION , GPS_CATEGORY , GPS_CATEGORY_DESCRIPTION ,
    GPS_MARKET , GPS_MARKET_DESCRIPTION , GPS_PROGRAM_CODE , GPS_PROGRAM_CODE_DESCRIPTION , MARGIN_LEVEL , PRODUCT_FRAME_TYPE , PRODUCT_FRAME_TYPE_DESCRIPTION , IS_NCNR , IS_PRICE_BOOK , IS_QUOTE ,
    IS_STEP_PRICING , STAR_LEVEL , IS_FIRST_TIME_IN_PRICE_BOOK , ON_TARGET_REMOVAL_DATE , ON_TARGET_START_DATE , PHASE_OUT_END_DATE , PHASE_OUT_START_DATE , REFERENCE_QUANTITY ,
    MINIMUM_ORDER_QUANTITY , RESALE_PRICE , MINIMUM_DOLLAR_VALUE , COGS_PRICE , DISTRIBUTOR_BOOK_PRICE_EUR , DISTRIBUTOR_BOOK_PRICE_JPY , SOURCE_SYSTEM , BIW_INS_DTTM , BIW_UPD_DTTM , BIW_BATCH_ID

)
    SELECT  MD5(OBJECT_CONSTRUCT('COL1' ,'E-F44013CAA-N1-W1-ACP'	    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'E-F44013CAA-N1-W1-ACP'			, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('E-F44013CAA-N1-W1-ACP')		, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-285241'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENG3V2T45ASY'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENG3V2T45ASY'						, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENG3V2T45ASY')					, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-285300'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENG99251AS001'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENG99251AS001'					, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENG99251AS001')				, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-271360'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENGF775B0STP247ASY'		    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENGF775B0STP247ASY'				, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENGF775B0STP247ASY')			, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-293099'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'     
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENGFDMC3612ASY1'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENGFDMC3612ASY1'					, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENGFDMC3612ASY1')				, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-255240'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'ENGNCV7755ASASY'			    ::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'ENGNCV7755ASASY'					, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('ENGNCV7755ASASY')				, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-274660'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'
UNION SELECT MD5(OBJECT_CONSTRUCT('COL1' ,'F2XDCHAINA8S-AAA3B462-DSG'	::STRING,'COL2', '1992-01-01 00:00:00.00'	::STRING)::STRING) , 'F2XDCHAINA8S-AAA3B462-DSG'		, '1992-01-01 00:00:00.00'	, '2059-01-01 00:00:00.00'	, NULL	, FALSE::BOOLEAN ,	MD5('F2XDCHAINA8S-AAA3B462-DSG')	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '0'	, '0'	, '-250020'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, '#'	, NULL	, NULL	, NULL	, NULL	, '1'	, '0'	, '0'	, '0'	, NULL	, '0'	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, NULL	, 'MODELN' , CURRENT_TIMESTAMP , CURRENT_TIMESTAMP , '9999'



{%endset%}

{################# Step 2 EXECUTE SCRIPTS #################}
{% do run_query(v_scripts) %}

{################# Step 3 CAPTURE INTO DBT TABLE #################}
{{
    config(
         description = 'Capture DBT DDL Execution Scripts'
        ,transient=false
        ,materialized='incremental'
        ,database = var('V_EDL_DEFAULT_DB')+env_var('DBT_DEP_ENV')
        ,schema ='UTILITY_DBT'
        ,alias='DBT_SNOWFLAKE_DDL_EXECUTION'
        ,unique_key= 'PCCT_NUMBER'
        )
}}
SELECT 
    592371 AS PCCT_NUMBER  ,
    '{{v_scripts|replace("'","''")}}' AS DDL_EXECUTED ,
    'VINAYAKA.CN' AS BIW_CREATED_BY,
    CURRENT_TIMESTAMP(0)::TIMESTAMP_NTZ AS BIW_CREATED_DTTM,
    'VINAYAKA.CN' AS BIW_UPD_BY ,
    CURRENT_TIMESTAMP(0)::TIMESTAMP_NTZ AS BIW_UPD_DTTM

{% endmacro %}