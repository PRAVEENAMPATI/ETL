{% macro PCCT_621906_1() -%}
 {################# Step 1 DECLARE SCRIPTS/DDL NEED TO EXECUTED #################}
{%- set v_scripts -%} 

INSERT INTO {{env_var('DBT_EDW_DB')~env_var('DBT_DEP_ENV')}}.MART_SALES.FUNNEL_FACT
WITH FUNNEL_FACT AS (
SELECT 
    FUNNEL_KEY, 
    SNAPSHOT_DATE_KEY,
    DIRECT_CUSTOMER_KEY, 
    INDIRECT_CUSTOMER_KEY, 
    END_CUSTOMER_KEY, 
    DIRECT_CORPORATION_KEY, 
    INDIRECT_CORPORATION_KEY, 
    END_CORPORATION_KEY, 
    MARKET_PRODUCT_NUMBER_KEY, 
    INTERNAL_PART_NUMBER_KEY,
    PRODUCTION_DATE_KEY, 
    DESIGN_REGISTRATION_KEY, 
    DESIGN_PART_MAPPING_KEY, 
    DECISION_DAY_KEY, 
    DESIGN_IN_DAY_KEY, 
    ACTION_DAY_KEY, 
    DIRECT_CUSTOMER_CODE, 
    INDIRECT_CUSTOMER_CODE, 
    END_CUSTOMER_CODE, 
    DIRECT_CORPORATION_CODE, 
    INDIRECT_CORPORATION_CODE, 
    END_CORPORATION_CODE, 
    MARKET_PRODUCT_NUMBER, 
    INTERNAL_PART_NUMBER,
    TRANSACTION_DATE, 
    DECISION_DATE,
    DESIGN_IN_DATE,  
    ACTION_DATE,     
    QUANTITY_PER_SYSTEM, 
    EXCHANGE_RATE, 
    TARGET_PRICE_USD, 
    NRE_USD, 
    DESIGN_REVENUE, 
    DESIGN_REVENUE_SHARE, 
    CONFIDENCE, 
    ONSHARE, 
    COMMISSIONABLE_NRE_USD, 
    COMMISSIONABLE_THREE_YEAR_REVENUE_USD, 
    THREE_YEAR_REVENUE, 
    LIFETIME_REVENUE, 
    NEW_BUSINESS_COMMIT_PCT, 
    COST_TO_DEV_USD, 
    ITEM_NUMBER, 
    OPERATIONAL_ASP, 
    REF_PRICE, 
    SIP_MULTIPLIER, 
    REGISTRATION_COST_ESTIMATE, 
    BU_PRICE, 
    TRANSACTION_CURRENCY_ISO_CODE, 
    PROJECT_VALUE_OVER_LIFETIME, 
    ONMARGIN_PERCENT_CUSTOMER_PRICE_REGULAR_PRICE, 
    CREATED_DATE, 
    MODIFIED_DATE, 
    PROTOTYPE_DATE, 
    SOCKET_STATUS_CHANGE_DATE, 
    REGISTRATION_ITEM_REQUEST_DATE, 
    REGISTRATION_ITEM_REVIEW_DATE, 
    REGISTRATION_ITEM_EXPIRE, 
    VALIDATED_DATE, 
    COMMISSION_WIN_DATE, 
    BLUESHEET_FIRST_ADD_DATE, 
    BLUESHEET_UPDATED_DATE, 
    SAMPLES_REQUIRED_DATE, 
    SEGMENT_MUSTWIN_SET_DATE, 
    EXEC_MUSTWIN_SET_DATE, 
    VP_MUSTWIN_SET_DATE, 
    CLAIM_WIN_DATE, 
    NEXT_MILESTONE_DATE, 
    OPPORTUNITY_DECISION_DATE, 
    BU_START_DATE, 
    BU_END_DATE, 
    ORIGINAL_APPROVAL_DATE, 
    ORIGINAL_DISPOSITION_DATE, 
    PROJECT_MODIFIED_DATE, 
    BU_DESIGN_IN_REQUEST_DATE, 
    IS_PART_ACTIVE, 
    IS_PRIMARY_OPN, 
    IS_OPPORTUNITY, 
    IS_REFERENCE_DESIGN, 
    IS_MUSTWIN, 
    IS_SEGMENT_MUSTWIN, 
    IS_EXECMUSTWIN, 
    IS_VPNMUSTWIN, 
    IS_DSM_REVIEW, 
    IS_BOM_EXPANSION, 
    IS_SUNSET, 
    IS_NPI, 
    CREATED_BY, 
    MODIFIED_BY, 
    OPPORTUNITY_NUMBER, 
    OPPORTUNITY_LIFECYCLE_STATUS, 
    DESIGN_TYPE, 
    CHANNEL_TYPE, 
    CHANNEL, 
    FSE, 
    FAE, 
    PRODUCT_MARKETER, 
    SEC_INVOLVEMENT, 
    PROGRAM_STATUS, 
    PROGRAM_NAME, 
    BOARD_NAME, 
    ESTIMATED_ANNUAL_BOARDS, 
    PART_TYPE, 
    LINE_DESCRIPTION, 
    SALES_SOCKET_STATUS, 
    CORPORATION_SOCKET_STATUS, 
    SEGMENT, 
    APPLICATION, 
    REGISTRATION_NUMBER, 
    ACTION_NOTES, 
    OPPORTUNITY_COMMENTS, 
    DISTRIBUTOR_NAME, 
    DISTRIBUTOR_BRANCH_NAME, 
    REGISTRATION_ITEM_REVIEWBY, 
    REGISTRATION_ITEM_STATUS, 
    REGISTRATION_ITEM_CANCEL_REJECT_REASON, 
    DISTRIBUTOR_FSE, 
    DISTRIBUTOR_FAE, 
    COMMISSION_UPDATED_BY, 
    COMMISSION_NOTES, 
    BLUE_SHEET_REQUIRED, 
    BLUE_SHEET_URL, 
    BU_STATUS, 
    BU_COMMENT, 
    CROSS_SELL_TYPE, 
    COMPETITION, 
    RYG_STATUS, 
    SWAT_TEAM, 
    REGISTRATION_ITEM_NUMBER, 
    DESIGN_STATUS, 
    BU_ACTION_NOTES, 
    BU_DESIGN_IN_REQUEST,
    POS50K_2M_REGOWNER,
    POS2MPLUS_REGOWNER,
    POS50K_2M_NON_REGOWNER,
    POS2MPLUS_NON_REGOWNER, 
    REBATE_NOTES, 
    REFERENCE_OPPORTUNITY_NUMBER, 
    DESIGN_IN_APPROVER, 
    BU_MARKETER_APPROVAL, 
    BU_MARKETER_APPROVER_ID, 
    BU_MARKETER_APPROVER_NAME, 
    DISTRIBUTOR_PROJECT_REF, 
    DISTRIBUTOR_DEVICE_REF, 
    BLOCK_DIAGRAM_COMPLETE, 
    OPPORTUNITY_REGISTRATION_TYPE, 
    TRANSFER_STATUS, 
    DISTRIBUTOR_NOTES, 
    SPLIT_REVIEW_STATUS, 
    LOW_MARGIN_EXCEPTION, 
    MARGIN_BUCKET, 
    NPI_STATUS, 
    NPI_NUMBER, 
    NPD_PROJECT_NUMBER, 
    OPPORTUNITY_LINE_CONTACT,
    SIP_REASON,
    DESIGNWIN_REQUEST_STATUS,
    CATCHUP_REG,
    EFFORT_TIER,
    PRODUCT_TIER,
    DESIGNIN_DESIGNWIN_APPROVER,
    SOURCE_SYSTEM,
    BIW_INS_DTTM ,
    BIW_UPD_DTTM ,
    BIW_BATCH_ID,
    BIW_MD5_KEY
FROM {{env_var('DBT_EDW_DB')~env_var('DBT_DEP_ENV')}}.MART_SALES.FUNNEL_FACT_PV20221213
),

DESIGN_OPPORTUNITY AS (
  SELECT   
    FUNNEL_KEY, 
    SNAPSHOT_DATE_KEY,
    DESIGN_TYPE,
    CREATED_DATE,
    ESTIMATED_ANNUAL_BOARDS,
    QUANTITY_PER_SYSTEM,
    TARGET_PRICE_USD,
    DESIGN_REVENUE_SHARE,
    ONSHARE,
    PROJECT_VALUE_OVER_LIFETIME,
    EXCHANGE_RATE
  FROM FUNNEL_FACT 
  WHERE DESIGN_TYPE='Opportunity' 
  AND TO_NUMBER(TO_CHAR(CREATED_DATE,'YYYYMMDD')) = SNAPSHOT_DATE_KEY - 1
),

DESIGN_REGISTRATION AS (
  SELECT   
    FUNNEL_KEY, 
    SNAPSHOT_DATE_KEY,
    DESIGN_TYPE,
    REGISTRATION_ITEM_REVIEW_DATE,
    REGISTRATION_ITEM_STATUS,
    ESTIMATED_ANNUAL_BOARDS,
    QUANTITY_PER_SYSTEM,
    TARGET_PRICE_USD,
    DESIGN_REVENUE_SHARE,
    ONSHARE,
    PROJECT_VALUE_OVER_LIFETIME,
    EXCHANGE_RATE
  FROM FUNNEL_FACT 
  WHERE DESIGN_TYPE='Registration' 
  AND TO_NUMBER(TO_CHAR(REGISTRATION_ITEM_REVIEW_DATE,'YYYYMMDD')) = SNAPSHOT_DATE_KEY - 1
  AND REGISTRATION_ITEM_STATUS IN ('Approved','Expired')
)

SELECT 
    FACT.FUNNEL_KEY, 
    FACT.SNAPSHOT_DATE_KEY,
    FACT.DIRECT_CUSTOMER_KEY, 
    FACT.INDIRECT_CUSTOMER_KEY, 
    FACT.END_CUSTOMER_KEY, 
    FACT.DIRECT_CORPORATION_KEY, 
    FACT.INDIRECT_CORPORATION_KEY, 
    FACT.END_CORPORATION_KEY, 
    FACT.MARKET_PRODUCT_NUMBER_KEY, 
    FACT.INTERNAL_PART_NUMBER_KEY,
    FACT.PRODUCTION_DATE_KEY, 
    FACT.DESIGN_REGISTRATION_KEY, 
    FACT.DESIGN_PART_MAPPING_KEY, 
    FACT.DECISION_DAY_KEY, 
    FACT.DESIGN_IN_DAY_KEY, 
    FACT.ACTION_DAY_KEY, 
    FACT.DIRECT_CUSTOMER_CODE, 
    FACT.INDIRECT_CUSTOMER_CODE, 
    FACT.END_CUSTOMER_CODE, 
    FACT.DIRECT_CORPORATION_CODE, 
    FACT.INDIRECT_CORPORATION_CODE, 
    FACT.END_CORPORATION_CODE, 
    FACT.MARKET_PRODUCT_NUMBER, 
    FACT.INTERNAL_PART_NUMBER,
    FACT.TRANSACTION_DATE, 
    FACT.DECISION_DATE,
    FACT.DESIGN_IN_DATE,  
    FACT.ACTION_DATE, 
    FACT.QUANTITY_PER_SYSTEM, 
    FACT.EXCHANGE_RATE, 
    FACT.TARGET_PRICE_USD, 
    FACT.NRE_USD, 
    FACT.DESIGN_REVENUE, 
    FACT.DESIGN_REVENUE_SHARE, 
    FACT.CONFIDENCE, 
    FACT.ONSHARE, 
    FACT.COMMISSIONABLE_NRE_USD, 
    FACT.COMMISSIONABLE_THREE_YEAR_REVENUE_USD, 
    FACT.THREE_YEAR_REVENUE, 
    FACT.LIFETIME_REVENUE, 
    FACT.NEW_BUSINESS_COMMIT_PCT, 
    FACT.COST_TO_DEV_USD, 
    FACT.ITEM_NUMBER, 
    FACT.OPERATIONAL_ASP, 
    FACT.REF_PRICE, 
    FACT.SIP_MULTIPLIER, 
    FACT.REGISTRATION_COST_ESTIMATE, 
    FACT.BU_PRICE, 
    FACT.TRANSACTION_CURRENCY_ISO_CODE, 
    FACT.PROJECT_VALUE_OVER_LIFETIME, 
    FACT.ONMARGIN_PERCENT_CUSTOMER_PRICE_REGULAR_PRICE, 
    FACT.CREATED_DATE, 
    FACT.MODIFIED_DATE, 
    FACT.PROTOTYPE_DATE, 
    FACT.SOCKET_STATUS_CHANGE_DATE, 
    FACT.REGISTRATION_ITEM_REQUEST_DATE, 
    FACT.REGISTRATION_ITEM_REVIEW_DATE, 
    FACT.REGISTRATION_ITEM_EXPIRE, 
    FACT.VALIDATED_DATE, 
    FACT.COMMISSION_WIN_DATE, 
    FACT.BLUESHEET_FIRST_ADD_DATE, 
    FACT.BLUESHEET_UPDATED_DATE, 
    FACT.SAMPLES_REQUIRED_DATE, 
    FACT.SEGMENT_MUSTWIN_SET_DATE, 
    FACT.EXEC_MUSTWIN_SET_DATE, 
    FACT.VP_MUSTWIN_SET_DATE, 
    FACT.CLAIM_WIN_DATE, 
    FACT.NEXT_MILESTONE_DATE, 
    FACT.OPPORTUNITY_DECISION_DATE, 
    FACT.BU_START_DATE, 
    FACT.BU_END_DATE, 
    FACT.ORIGINAL_APPROVAL_DATE, 
    FACT.ORIGINAL_DISPOSITION_DATE, 
    FACT.PROJECT_MODIFIED_DATE, 
    FACT.BU_DESIGN_IN_REQUEST_DATE, 
    FACT.IS_PART_ACTIVE, 
    FACT.IS_PRIMARY_OPN, 
    FACT.IS_OPPORTUNITY, 
    FACT.IS_REFERENCE_DESIGN, 
    FACT.IS_MUSTWIN, 
    FACT.IS_SEGMENT_MUSTWIN, 
    FACT.IS_EXECMUSTWIN, 
    FACT.IS_VPNMUSTWIN, 
    FACT.IS_DSM_REVIEW, 
    FACT.IS_BOM_EXPANSION, 
    FACT.IS_SUNSET, 
    FACT.IS_NPI, 
    FACT.CREATED_BY, 
    FACT.MODIFIED_BY, 
    FACT.OPPORTUNITY_NUMBER, 
    FACT.OPPORTUNITY_LIFECYCLE_STATUS, 
    FACT.DESIGN_TYPE, 
    FACT.CHANNEL_TYPE, 
    FACT.CHANNEL, 
    FACT.FSE, 
    FACT.FAE, 
    FACT.PRODUCT_MARKETER, 
    FACT.SEC_INVOLVEMENT, 
    FACT.PROGRAM_STATUS, 
    FACT.PROGRAM_NAME, 
    FACT.BOARD_NAME, 
    FACT.ESTIMATED_ANNUAL_BOARDS, 
    FACT.PART_TYPE, 
    FACT.LINE_DESCRIPTION, 
    FACT.SALES_SOCKET_STATUS, 
    FACT.CORPORATION_SOCKET_STATUS, 
    FACT.SEGMENT, 
    FACT.APPLICATION, 
    FACT.REGISTRATION_NUMBER, 
    FACT.ACTION_NOTES, 
    FACT.OPPORTUNITY_COMMENTS, 
    FACT.DISTRIBUTOR_NAME, 
    FACT.DISTRIBUTOR_BRANCH_NAME, 
    FACT.REGISTRATION_ITEM_REVIEWBY, 
    FACT.REGISTRATION_ITEM_STATUS, 
    FACT.REGISTRATION_ITEM_CANCEL_REJECT_REASON, 
    FACT.DISTRIBUTOR_FSE, 
    FACT.DISTRIBUTOR_FAE, 
    FACT.COMMISSION_UPDATED_BY, 
    FACT.COMMISSION_NOTES, 
    FACT.BLUE_SHEET_REQUIRED, 
    FACT.BLUE_SHEET_URL, 
    FACT.BU_STATUS, 
    FACT.BU_COMMENT, 
    FACT.CROSS_SELL_TYPE, 
    FACT.COMPETITION, 
    FACT.RYG_STATUS, 
    FACT.SWAT_TEAM, 
    FACT.REGISTRATION_ITEM_NUMBER, 
    FACT.DESIGN_STATUS, 
    FACT.BU_ACTION_NOTES, 
    FACT.BU_DESIGN_IN_REQUEST,
    FACT.POS50K_2M_REGOWNER,
    FACT.POS2MPLUS_REGOWNER,
    FACT.POS50K_2M_NON_REGOWNER,
    FACT.POS2MPLUS_NON_REGOWNER, 
    FACT.REBATE_NOTES, 
    FACT.REFERENCE_OPPORTUNITY_NUMBER, 
    FACT.DESIGN_IN_APPROVER, 
    FACT.BU_MARKETER_APPROVAL, 
    FACT.BU_MARKETER_APPROVER_ID, 
    FACT.BU_MARKETER_APPROVER_NAME, 
    FACT.DISTRIBUTOR_PROJECT_REF, 
    FACT.DISTRIBUTOR_DEVICE_REF, 
    FACT.BLOCK_DIAGRAM_COMPLETE, 
    FACT.OPPORTUNITY_REGISTRATION_TYPE, 
    FACT.TRANSFER_STATUS, 
    FACT.DISTRIBUTOR_NOTES, 
    FACT.SPLIT_REVIEW_STATUS, 
    FACT.LOW_MARGIN_EXCEPTION, 
    FACT.MARGIN_BUCKET, 
    FACT.NPI_STATUS, 
    FACT.NPI_NUMBER, 
    FACT.NPD_PROJECT_NUMBER, 
    FACT.OPPORTUNITY_LINE_CONTACT,
    FACT.SIP_REASON,
    FACT.DESIGNWIN_REQUEST_STATUS,
    FACT.CATCHUP_REG,
    FACT.EFFORT_TIER,
    FACT.PRODUCT_TIER,
    FACT.DESIGNIN_DESIGNWIN_APPROVER,
    FACT.SOURCE_SYSTEM,
    COALESCE(REG.ESTIMATED_ANNUAL_BOARDS,OPP.ESTIMATED_ANNUAL_BOARDS) AS CREATED_ESTIMATED_ANNUAL_BOARDS,
    COALESCE(REG.QUANTITY_PER_SYSTEM,OPP.QUANTITY_PER_SYSTEM) AS CREATED_QUANTITY_PER_SYSTEM, 
    COALESCE(REG.TARGET_PRICE_USD,OPP.TARGET_PRICE_USD) AS CREATED_TARGET_PRICE_USD, 
    COALESCE(REG.DESIGN_REVENUE_SHARE,OPP.DESIGN_REVENUE_SHARE) AS CREATED_DESIGN_REVENUE_SHARE, 
    COALESCE(REG.ONSHARE,OPP.ONSHARE) AS CREATED_ONSHARE, 
    COALESCE(REG.PROJECT_VALUE_OVER_LIFETIME/REG.EXCHANGE_RATE,OPP.PROJECT_VALUE_OVER_LIFETIME/OPP.EXCHANGE_RATE) AS CREATED_PROJECT_VALUE_OVER_LIFETIME, 
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.DESIGN_IN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1 
      THEN FACT.ESTIMATED_ANNUAL_BOARDS 
    END AS DIN_ESTIMATED_ANNUAL_BOARDS,
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.DESIGN_IN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1
      THEN FACT.QUANTITY_PER_SYSTEM 
    END AS DIN_QUANTITY_PER_SYSTEM, 
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.DESIGN_IN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1
      THEN FACT.TARGET_PRICE_USD 
    END AS DIN_TARGET_PRICE_USD, 
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.DESIGN_IN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1
      THEN FACT.DESIGN_REVENUE_SHARE 
    END AS DIN_DESIGN_REVENUE_SHARE,
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.DESIGN_IN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1
      THEN FACT.ONSHARE
    END AS DIN_ONSHARE,
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.DESIGN_IN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1
      THEN FACT.PROJECT_VALUE_OVER_LIFETIME/FACT.EXCHANGE_RATE 
    END AS DIN_PROJECT_VALUE_OVER_LIFETIME,
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.CLAIM_WIN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1   
      THEN FACT.ESTIMATED_ANNUAL_BOARDS
    END AS DWIN_ESTIMATED_ANNUAL_BOARDS, 
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.CLAIM_WIN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1   
      THEN FACT.QUANTITY_PER_SYSTEM 
    END AS DWIN_QUANTITY_PER_SYSTEM, 
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.CLAIM_WIN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1  
      THEN FACT.TARGET_PRICE_USD
    END AS DWIN_TARGET_PRICE_USD, 
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.CLAIM_WIN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1  
      THEN FACT.DESIGN_REVENUE_SHARE 
    END AS DWIN_DESIGN_REVENUE_SHARE,
    CASE 
      WHEN TO_NUMBER(TO_CHAR(FACT.CLAIM_WIN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1
      THEN FACT.ONSHARE 
    END AS DWIN_ONSHARE,
    CASE
      WHEN TO_NUMBER(TO_CHAR(FACT.CLAIM_WIN_DATE,'YYYYMMDD')) = FACT.SNAPSHOT_DATE_KEY - 1 
      THEN FACT.PROJECT_VALUE_OVER_LIFETIME/FACT.EXCHANGE_RATE
    END AS DWIN_PROJECT_VALUE_OVER_LIFETIME,       
    FACT.BIW_INS_DTTM ,
    FACT.BIW_UPD_DTTM ,
    FACT.BIW_BATCH_ID,
    FACT.BIW_MD5_KEY
FROM FUNNEL_FACT FACT 
LEFT OUTER JOIN  DESIGN_OPPORTUNITY OPP 
ON FACT.FUNNEL_KEY = OPP.FUNNEL_KEY
AND FACT.SNAPSHOT_DATE_KEY = OPP.SNAPSHOT_DATE_KEY
LEFT OUTER JOIN  DESIGN_REGISTRATION REG 
ON FACT.FUNNEL_KEY = REG.FUNNEL_KEY
AND FACT.SNAPSHOT_DATE_KEY = REG.SNAPSHOT_DATE_KEY
WHERE FACT.SNAPSHOT_DATE_KEY NOT IN  ( SELECT SNAPSHOT_DATE_KEY
                                      FROM {{env_var('DBT_EDW_DB')~env_var('DBT_DEP_ENV')}}.MART_SALES.FUNNEL_FACT);

{%endset%}

{################# Step 2 EXECUTE SCRIPTS #################}
{% do run_query(v_scripts) %}

{################# Step 3 CAPTURE INTO DBT TABLE #################}
Insert into var('V_EDL_DEFAULT_DB')+env_var('DBT_DEP_ENV').UTILITY_DBT.DBT_SNOWFLAKE_DDL_EXECUTION
SELECT 
    621906_1 AS PCCT_NUMBER  ,
    '{{v_scripts|replace("'","''")}}' AS DDL_EXECUTED ,
    'VINAY.SUBRAMANIAN' AS BIW_CREATED_BY,
    CURRENT_TIMESTAMP(0)::TIMESTAMP_NTZ AS BIW_CREATED_DTTM,
    'VINAY.SUBRAMANIAN' AS BIW_UPD_BY ,
    CURRENT_TIMESTAMP(0)::TIMESTAMP_NTZ AS BIW_UPD_DTTM
{% endmacro %}